<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>EP04: Monodomain ECG · Thunderbolt.jl</title><meta name="title" content="EP04: Monodomain ECG · Thunderbolt.jl"/><meta property="og:title" content="EP04: Monodomain ECG · Thunderbolt.jl"/><meta property="twitter:title" content="EP04: Monodomain ECG · Thunderbolt.jl"/><meta name="description" content="Documentation for Thunderbolt.jl."/><meta property="og:description" content="Documentation for Thunderbolt.jl."/><meta property="twitter:description" content="Documentation for Thunderbolt.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/custom.css" rel="stylesheet" type="text/css"/><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="Thunderbolt.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Thunderbolt.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../">Overview</a></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Continuum Mechanics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../cm01_simple-active-stress/">CM01: Simple Active Stress</a></li><li><a class="tocitem" href="../cm02_prestress/">CM02: Prestressing (WIP)</a></li><li><a class="tocitem" href="../cm03_3d0d-coupling/">CM03: 0D Blood Circuit</a></li><li><a class="tocitem" href="../cm04_pericardium/">CM04: Pericadium (TODO)</a></li><li><a class="tocitem" href="../cm05_fourchambers/">CM05: Four Chamber (TODO)</a></li><li><a class="tocitem" href="../cm06_heartvalves/">CM06: Heart Valves (TODO)</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox" checked/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Electrophysiology</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../ep01_spiral-wave/">EP01: Spiral Wave</a></li><li><a class="tocitem" href="../ep02_purkinje/">EP02: Purkinje Network (TODO)</a></li><li><a class="tocitem" href="../ep03_bidomain/">EP03: Defibrillation (TODO)</a></li><li class="is-active"><a class="tocitem" href>EP04: Monodomain ECG</a><ul class="internal"><li><a class="tocitem" href="#Commented-Program"><span>Commented Program</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li><li><a class="tocitem" href="#ep-tutorial_geselowitz-ecg-plain-program"><span>Plain program</span></a></li></ul></li><li><a class="tocitem" href="../ep05_eikonal/">EP05: Eikonal Models (WIP)</a></li><li><a class="tocitem" href="../ep06_pacemaker/">EP06: Pacemakers (TODO)</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Topic Guides</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../topics/">Overview</a></li><li><a class="tocitem" href="../../topics/operators/">Operators</a></li><li><a class="tocitem" href="../../topics/couplers/">Couplers</a></li><li><a class="tocitem" href="../../topics/time-integration/">Time Integration</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">How-to guides</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../howto/">Overview</a></li><li><a class="tocitem" href="../../howto/benchmarking/">Benchmarking</a></li><li><a class="tocitem" href="../../howto/custom-ep-cell-model/">Adding EP Cell Models</a></li><li><a class="tocitem" href="../../howto/custom-stimulation-protocols/">Custom Stimulation Protocols</a></li><li><a class="tocitem" href="../../howto/custom-energies/">Adding Energies</a></li><li><a class="tocitem" href="../../howto/custom-sarcomere/">Adding Sarcomeres</a></li><li><a class="tocitem" href="../../howto/custom-elements/">Adding New Elements</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">API Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api-reference/">Overview</a></li><li><a class="tocitem" href="../../api-reference/models/">Models</a></li><li><a class="tocitem" href="../../api-reference/mesh/">Mesh</a></li><li><a class="tocitem" href="../../api-reference/functions/">Functions</a></li><li><a class="tocitem" href="../../api-reference/problems/">Problems</a></li><li><a class="tocitem" href="../../api-reference/discretization/">Discretization</a></li><li><a class="tocitem" href="../../api-reference/operators/">Operators</a></li><li><a class="tocitem" href="../../api-reference/solver/">Solver</a></li><li><a class="tocitem" href="../../api-reference/utility/">Utility</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Developer Documentation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../devdocs/">Overview</a></li><li><a class="tocitem" href="../../devdocs/element_interface/">Element Interface</a></li><li><a class="tocitem" href="../../devdocs/domain_management/">Domain management</a></li></ul></li><li><a class="tocitem" href="../../vroom/">Performance Tips</a></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li><a class="is-disabled">Electrophysiology</a></li><li class="is-active"><a href>EP04: Monodomain ECG</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>EP04: Monodomain ECG</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/termi-official/Thunderbolt.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/termi-official/Thunderbolt.jl/blob/main/docs/src/literate-tutorials/ep04_geselowitz-ecg.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="ep-tutorial_geselowitz-ecg"><a class="docs-heading-anchor" href="#ep-tutorial_geselowitz-ecg">Electrophysiology Tutorial 4: Geselowitz ECG with Monodomain Model</a><a id="ep-tutorial_geselowitz-ecg-1"></a><a class="docs-heading-anchor-permalink" href="#ep-tutorial_geselowitz-ecg" title="Permalink"></a></h1><div class="admonition is-todo"><header class="admonition-header">Todo</header><div class="admonition-body"><p>Show computed ECG.</p></div></div><p>This tutorial shows how to setup ECG problems with monodomain models as the source and compute the QRS complex in a simple toy problem.</p><div class="admonition is-todo"><header class="admonition-header">Todo</header><div class="admonition-body"><p>Provide context.</p></div></div><h2 id="Commented-Program"><a class="docs-heading-anchor" href="#Commented-Program">Commented Program</a><a id="Commented-Program-1"></a><a class="docs-heading-anchor-permalink" href="#Commented-Program" title="Permalink"></a></h2><pre><code class="language-julia hljs">using Thunderbolt, LinearAlgebra, StaticArrays</code></pre><div class="admonition is-todo"><header class="admonition-header">Todo</header><div class="admonition-body"><p>The initializer API is not yet finished and hence we deconstruct stuff here manually. Please note that this method is quite fragile w.r.t. to many changes you can make in the code below.</p></div></div><pre><code class="language-julia hljs">function steady_state_initializer!(u₀, f::GenericSplitFunction)
    # TODO cleaner implementation. We need to extract this from the types or via dispatch.
    heatfun = f.functions[1]
    heat_dofrange = f.solution_indices[1]
    odefun = f.functions[2]
    ionic_model = odefun.ode

    φ₀ = @view u₀[heat_dofrange];
    # TODO extraction these via utility functions
    dh = heatfun.dh
    s₀flat = @view u₀[(ndofs(dh)+1):end];
    # Should not be reshape but some array of arrays fun
    s₀ = reshape(s₀flat, (ndofs(dh), Thunderbolt.num_states(ionic_model)-1));
    default_values = Thunderbolt.default_initial_state(ionic_model)

    φ₀ .= default_values[1]
    for i ∈ 1:(Thunderbolt.num_states(ionic_model)-1)
        s₀[:, i] .= default_values[i+1]
    end
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">steady_state_initializer! (generic function with 1 method)</code></pre><p>We start by defining a custom activation function</p><pre><code class="language-julia hljs">Base.@kwdef struct UniformEndocardialActivation &lt;: Function
    transmural_depth::Float64 = 0.15
end
function (p::UniformEndocardialActivation)(x::Vec{3}, t)
    τᶠ = 0.25
    # TODO source for this
    if t ≤ 2.0 &amp;&amp; x[1] &lt; p.transmural_depth
        return 0.5/τᶠ * exp(t/τᶠ)
    else
        return 0.0
    end
end
protocol = Thunderbolt.AnalyticalTransmembraneStimulationProtocol(
    AnalyticalCoefficient(
        UniformEndocardialActivation(),
        CoordinateSystemCoefficient(CartesianCoordinateSystem{3}())
    ),
    [SVector((-Inf, Inf))],
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">AnalyticalTransmembraneStimulationProtocol{AnalyticalCoefficient{Main.var&quot;Main&quot;.UniformEndocardialActivation, CoordinateSystemCoefficient{CartesianCoordinateSystem{3, Float32}}}, Float64, Vector{StaticArraysCore.SVector{2, Float64}}}(AnalyticalCoefficient{Main.var&quot;Main&quot;.UniformEndocardialActivation, CoordinateSystemCoefficient{CartesianCoordinateSystem{3, Float32}}}(Main.var&quot;Main&quot;.UniformEndocardialActivation(0.15), CoordinateSystemCoefficient{CartesianCoordinateSystem{3, Float32}}(CartesianCoordinateSystem{3, Float32}())), StaticArraysCore.SVector{2, Float64}[[-Inf, Inf]])</code></pre><p>We also generate both meshes</p><pre><code class="language-julia hljs">num_elements_heart = (32,16,16)
heart_mesh = generate_mesh(Tetrahedron, num_elements_heart, Vec((1.5, 1.5, 0.0)), Vec((5.5, 3.5, 2.0)))
num_elements_torso = (56,40,28)
torso_mesh = generate_mesh(Hexahedron,  num_elements_torso, Vec((0.0, 0.0, 0.0)), Vec((7.0, 5.0, 3.5)))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Thunderbolt.SimpleMesh{3, Hexahedron, Float64} with 980 Hexahedron cells and 1320 nodes
  Surface subdomains:
    left 70 Hexahedron cells
    bottom 140 Hexahedron cells
    right 70 Hexahedron cells
    back 98 Hexahedron cells
    top 140 Hexahedron cells
    front 98 Hexahedron cells
</code></pre><p>Then we place some electrodes and leads.</p><pre><code class="language-julia hljs">ground_vertex = Thunderbolt.get_closest_vertex(Vec(0.0, 0.0, 0.0), torso_mesh)
leads = [
    [Vec( 0.,   0.,  1.5), Vec( 7.,   0.,  1.5)],
    [Vec( 3.5,  0.,  1.5), Vec( 3.5,  5.,  1.5)],
]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{Vector{Vec{3, Float64}}}:
 [[0.0, 0.0, 1.5], [7.0, 0.0, 1.5]]
 [[3.5, 0.0, 1.5], [3.5, 5.0, 1.5]]</code></pre><p>For our toy problem we use a very simple microstructure.</p><pre><code class="language-julia hljs">microstructure = OrthotropicMicrostructureModel(
    ConstantCoefficient((Vec(0.0,0.0,1.0))),
    ConstantCoefficient((Vec(0.0,1.0,0.0))),
    ConstantCoefficient((Vec(1.0,0.0,0.0))),
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">OrthotropicMicrostructureModel{ConstantCoefficient{Vec{3, Float64}}, ConstantCoefficient{Vec{3, Float64}}, ConstantCoefficient{Vec{3, Float64}}}(ConstantCoefficient{Vec{3, Float64}}([0.0, 0.0, 1.0]), ConstantCoefficient{Vec{3, Float64}}([0.0, 1.0, 0.0]), ConstantCoefficient{Vec{3, Float64}}([1.0, 0.0, 0.0]))</code></pre><p>With the microstructure we setup the diffusion tensor field in spectral form.</p><div class="admonition is-todo"><header class="admonition-header">Todo</header><div class="admonition-body"><p>citation</p></div></div><pre><code class="language-julia hljs">κ₁ = 0.17 * 0.62 / (0.17 + 0.62)
κᵣ = 0.019 * 0.24 / (0.019 + 0.24)
diffusion_tensor_field = SpectralTensorCoefficient(
    microstructure,
    ConstantCoefficient(SVector(κ₁, κᵣ, κᵣ))
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SpectralTensorCoefficient{OrthotropicMicrostructureModel{ConstantCoefficient{Vec{3, Float64}}, ConstantCoefficient{Vec{3, Float64}}, ConstantCoefficient{Vec{3, Float64}}}, ConstantCoefficient{StaticArraysCore.SVector{3, Float64}}}(OrthotropicMicrostructureModel{ConstantCoefficient{Vec{3, Float64}}, ConstantCoefficient{Vec{3, Float64}}, ConstantCoefficient{Vec{3, Float64}}}(ConstantCoefficient{Vec{3, Float64}}([0.0, 0.0, 1.0]), ConstantCoefficient{Vec{3, Float64}}([0.0, 1.0, 0.0]), ConstantCoefficient{Vec{3, Float64}}([1.0, 0.0, 0.0])), ConstantCoefficient{StaticArraysCore.SVector{3, Float64}}([0.13341772151898734, 0.017606177606177605, 0.017606177606177605]))</code></pre><p>Now we setup our monodomain solver as usual.</p><pre><code class="language-julia hljs">cellmodel = Thunderbolt.PCG2019()
heart_model = MonodomainModel(
    ConstantCoefficient(1.0),
    ConstantCoefficient(1.0),
    diffusion_tensor_field,
    protocol,
    cellmodel,
    :φₘ, :s
)
heart_odeform = semidiscretize(
    ReactionDiffusionSplit(heart_model),
    FiniteElementDiscretization(Dict(:φₘ =&gt; LagrangeCollection{1}())),
    heart_mesh,
)
u₀ = zeros(Float64, OS.function_size(heart_odeform))
steady_state_initializer!(u₀, heart_odeform)
dt₀ = 0.01
dtvis = 0.5
Tₘₐₓ = 50.0
tspan = (0.0, Tₘₐₓ)
problem = OS.OperatorSplittingProblem(heart_odeform, u₀, tspan)
timestepper = OS.LieTrotterGodunov((
    BackwardEulerSolver(),
    ForwardEulerCellSolver(),
))
integrator = init(problem, timestepper, dt=dt₀, verbose=true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">t: 0.0
u: 1575-element Vector{Float64}:
 -85.0
 -85.0
 -85.0
 -85.0
 -85.0
 -85.0
 -85.0
 -85.0
 -85.0
 -85.0
   ⋮
   0.00012530739244227137
   0.00012530739244227137
   0.00012530739244227137
   0.00012530739244227137
   0.00012530739244227137
   0.00012530739244227137
   0.00012530739244227137
   0.00012530739244227137
   0.00012530739244227137</code></pre><p>Now that the time integrator is ready we setup the ECG problem.</p><pre><code class="language-julia hljs">torso_mesh_κᵢ = ConstantCoefficient(1.0)
torso_mesh_κ  = ConstantCoefficient(1.0)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ConstantCoefficient{Float64}(1.0)</code></pre><div class="admonition is-todo"><header class="admonition-header">Todo</header><div class="admonition-body"><p>Show how to transfer <code>diffusion_tensor_field</code> onto the torso mesh.</p></div></div><pre><code class="language-julia hljs">geselowitz_ecg = Thunderbolt.Geselowitz1989ECGLeadCache(
    heart_odeform,
    torso_mesh,
    torso_mesh_κᵢ,
    torso_mesh_κ,
    leads;
    ground = Thunderbolt.OrderedSet([ground_vertex])
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Thunderbolt.Geselowitz1989ECGLeadCache{Matrix{Float64}, Thunderbolt.AssembledBilinearOperator{Thunderbolt.ThreadedSparseMatrixCSR{Float64, Int64}, SparseArrays.SparseMatrixCSC{Float64, Int64}, Thunderbolt.BilinearDiffusionIntegrator{ConstantCoefficient{Float64}}, DofHandler{3, Thunderbolt.SimpleMesh{3, Tetrahedron, Float64}}}, Thunderbolt.NodalIntergridInterpolation{PointEvalHandler{Thunderbolt.SimpleMesh{3, Tetrahedron, Float64}, Float64}, DofHandler{3, Thunderbolt.SimpleMesh{3, Tetrahedron, Float64}}, DofHandler{3, Thunderbolt.SimpleMesh{3, Hexahedron, Float64}}}, Vector{Float64}, Vector{Vector{VertexIndex}}}(Thunderbolt.AssembledBilinearOperator{Thunderbolt.ThreadedSparseMatrixCSR{Float64, Int64}, SparseArrays.SparseMatrixCSC{Float64, Int64}, Thunderbolt.BilinearDiffusionIntegrator{ConstantCoefficient{Float64}}, DofHandler{3, Thunderbolt.SimpleMesh{3, Tetrahedron, Float64}}}([-0.3333333333333333 0.16666666666666666 … 0.0 0.0; 0.16666666666666666 -0.8333333333333333 … 0.0 0.0; … ; 0.0 0.0 … -0.8333333333333334 0.16666666666666666; 0.0 0.0 … 0.16666666666666666 -0.3333333333333333], sparse([1, 2, 3, 4, 5, 1, 2, 3, 4, 5  …  215, 216, 223, 224, 225, 171, 180, 216, 224, 225], [1, 1, 1, 1, 1, 2, 2, 2, 2, 2  …  224, 224, 224, 224, 224, 225, 225, 225, 225, 225], [-0.3333333333333333, 0.16666666666666666, 0.08333333333333333, 0.0, 0.08333333333333333, 0.16666666666666666, -0.8333333333333333, 0.0, 0.0, 0.0  …  0.25, 0.0, 0.16666666666666666, -0.8333333333333334, 0.16666666666666666, 0.0, 0.08333333333333333, 0.08333333333333333, 0.16666666666666666, -0.3333333333333333], 225, 225), Thunderbolt.BilinearDiffusionIntegrator{ConstantCoefficient{Float64}}(ConstantCoefficient{Float64}(1.0)), QuadratureRuleCollection{2}(), DofHandler{3, Thunderbolt.SimpleMesh{3, Tetrahedron, Float64}}(SubDofHandler{DofHandler{3, Thunderbolt.SimpleMesh{3, Tetrahedron, Float64}}}[SubDofHandler{DofHandler{3, Thunderbolt.SimpleMesh{3, Tetrahedron, Float64}}}(DofHandler{3, Thunderbolt.SimpleMesh{3, Tetrahedron, Float64}}(#= circular reference @-3 =#), OrderedCollections.OrderedSet{Int64}([1, 2, 3, 4, 5, 6, 7, 8, 9, 10  …  759, 760, 761, 762, 763, 764, 765, 766, 767, 768]), [:ϕₘ], Interpolation[Lagrange{RefTetrahedron, 1}()], Int64[], 4)], [:ϕₘ], [1, 2, 3, 4, 1, 5, 2, 4, 2, 6  …  180, 224, 171, 215, 216, 224, 171, 216, 225, 224], [1, 5, 9, 13, 17, 21, 25, 29, 33, 37  …  3033, 3037, 3041, 3045, 3049, 3053, 3057, 3061, 3065, 3069], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1  …  1, 1, 1, 1, 1, 1, 1, 1, 1, 1], true, Thunderbolt.SimpleMesh{3, Tetrahedron, Float64}(Grid{3, Tetrahedron, Float64}(Tetrahedron[Tetrahedron((1, 2, 10, 55)), Tetrahedron((1, 46, 2, 55)), Tetrahedron((2, 11, 10, 55)), Tetrahedron((2, 56, 11, 55)), Tetrahedron((2, 46, 47, 55)), Tetrahedron((2, 47, 56, 55)), Tetrahedron((2, 3, 11, 56)), Tetrahedron((2, 47, 3, 56)), Tetrahedron((3, 12, 11, 56)), Tetrahedron((3, 57, 12, 56))  …  Tetrahedron((170, 179, 178, 223)), Tetrahedron((170, 224, 179, 223)), Tetrahedron((170, 214, 215, 223)), Tetrahedron((170, 215, 224, 223)), Tetrahedron((170, 171, 179, 224)), Tetrahedron((170, 215, 171, 224)), Tetrahedron((171, 180, 179, 224)), Tetrahedron((171, 225, 180, 224)), Tetrahedron((171, 215, 216, 224)), Tetrahedron((171, 216, 225, 224))], Node{3, Float64}[Node{3, Float64}([1.5, 1.5, 0.0]), Node{3, Float64}([2.0, 1.5, 0.0]), Node{3, Float64}([2.5, 1.5, 0.0]), Node{3, Float64}([3.0, 1.5, 0.0]), Node{3, Float64}([3.5, 1.5, 0.0]), Node{3, Float64}([4.0, 1.5, 0.0]), Node{3, Float64}([4.5, 1.5, 0.0]), Node{3, Float64}([5.0, 1.5, 0.0]), Node{3, Float64}([5.5, 1.5, 0.0]), Node{3, Float64}([1.5, 2.0, 0.0])  …  Node{3, Float64}([5.5, 3.0, 2.0]), Node{3, Float64}([1.5, 3.5, 2.0]), Node{3, Float64}([2.0, 3.5, 2.0]), Node{3, Float64}([2.5, 3.5, 2.0]), Node{3, Float64}([3.0, 3.5, 2.0]), Node{3, Float64}([3.5, 3.5, 2.0]), Node{3, Float64}([4.0, 3.5, 2.0]), Node{3, Float64}([4.5, 3.5, 2.0]), Node{3, Float64}([5.0, 3.5, 2.0]), Node{3, Float64}([5.5, 3.5, 2.0])], Dict{String, OrderedCollections.OrderedSet{Int64}}(), Dict{String, OrderedCollections.OrderedSet{Int64}}(), Dict{String, OrderedCollections.OrderedSet{FacetIndex}}(&quot;left&quot; =&gt; OrderedCollections.OrderedSet{FacetIndex}([FacetIndex((1, 4)), FacetIndex((2, 2)), FacetIndex((49, 4)), FacetIndex((50, 2)), FacetIndex((97, 4)), FacetIndex((98, 2)), FacetIndex((145, 4)), FacetIndex((146, 2)), FacetIndex((193, 4)), FacetIndex((194, 2))  …  FacetIndex((529, 4)), FacetIndex((530, 2)), FacetIndex((577, 4)), FacetIndex((578, 2)), FacetIndex((625, 4)), FacetIndex((626, 2)), FacetIndex((673, 4)), FacetIndex((674, 2)), FacetIndex((721, 4)), FacetIndex((722, 2))]), &quot;bottom&quot; =&gt; OrderedCollections.OrderedSet{FacetIndex}([FacetIndex((1, 1)), FacetIndex((3, 1)), FacetIndex((7, 1)), FacetIndex((9, 1)), FacetIndex((13, 1)), FacetIndex((15, 1)), FacetIndex((19, 1)), FacetIndex((21, 1)), FacetIndex((25, 1)), FacetIndex((27, 1))  …  FacetIndex((163, 1)), FacetIndex((165, 1)), FacetIndex((169, 1)), FacetIndex((171, 1)), FacetIndex((175, 1)), FacetIndex((177, 1)), FacetIndex((181, 1)), FacetIndex((183, 1)), FacetIndex((187, 1)), FacetIndex((189, 1))]), &quot;right&quot; =&gt; OrderedCollections.OrderedSet{FacetIndex}([FacetIndex((46, 1)), FacetIndex((48, 1)), FacetIndex((94, 1)), FacetIndex((96, 1)), FacetIndex((142, 1)), FacetIndex((144, 1)), FacetIndex((190, 1)), FacetIndex((192, 1)), FacetIndex((238, 1)), FacetIndex((240, 1))  …  FacetIndex((574, 1)), FacetIndex((576, 1)), FacetIndex((622, 1)), FacetIndex((624, 1)), FacetIndex((670, 1)), FacetIndex((672, 1)), FacetIndex((718, 1)), FacetIndex((720, 1)), FacetIndex((766, 1)), FacetIndex((768, 1))]), &quot;back&quot; =&gt; OrderedCollections.OrderedSet{FacetIndex}([FacetIndex((147, 3)), FacetIndex((148, 3)), FacetIndex((153, 3)), FacetIndex((154, 3)), FacetIndex((159, 3)), FacetIndex((160, 3)), FacetIndex((165, 3)), FacetIndex((166, 3)), FacetIndex((171, 3)), FacetIndex((172, 3))  …  FacetIndex((741, 3)), FacetIndex((742, 3)), FacetIndex((747, 3)), FacetIndex((748, 3)), FacetIndex((753, 3)), FacetIndex((754, 3)), FacetIndex((759, 3)), FacetIndex((760, 3)), FacetIndex((765, 3)), FacetIndex((766, 3))]), &quot;top&quot; =&gt; OrderedCollections.OrderedSet{FacetIndex}([FacetIndex((581, 3)), FacetIndex((582, 3)), FacetIndex((587, 3)), FacetIndex((588, 3)), FacetIndex((593, 3)), FacetIndex((594, 3)), FacetIndex((599, 3)), FacetIndex((600, 3)), FacetIndex((605, 3)), FacetIndex((606, 3))  …  FacetIndex((743, 3)), FacetIndex((744, 3)), FacetIndex((749, 3)), FacetIndex((750, 3)), FacetIndex((755, 3)), FacetIndex((756, 3)), FacetIndex((761, 3)), FacetIndex((762, 3)), FacetIndex((767, 3)), FacetIndex((768, 3))]), &quot;front&quot; =&gt; OrderedCollections.OrderedSet{FacetIndex}([FacetIndex((2, 1)), FacetIndex((5, 1)), FacetIndex((8, 1)), FacetIndex((11, 1)), FacetIndex((14, 1)), FacetIndex((17, 1)), FacetIndex((20, 1)), FacetIndex((23, 1)), FacetIndex((26, 1)), FacetIndex((29, 1))  …  FacetIndex((596, 1)), FacetIndex((599, 1)), FacetIndex((602, 1)), FacetIndex((605, 1)), FacetIndex((608, 1)), FacetIndex((611, 1)), FacetIndex((614, 1)), FacetIndex((617, 1)), FacetIndex((620, 1)), FacetIndex((623, 1))])), Dict{String, OrderedCollections.OrderedSet{VertexIndex}}()), OrderedCollections.OrderedDict((1, 2, 10) =&gt; 1, (1, 2, 55) =&gt; 2, (2, 10, 55) =&gt; 3, (1, 10, 55) =&gt; 4, (1, 2, 46) =&gt; 5, (1, 46, 55) =&gt; 6, (2, 46, 55) =&gt; 7, (2, 10, 11) =&gt; 8, (2, 11, 55) =&gt; 9, (10, 11, 55) =&gt; 10…), OrderedCollections.OrderedDict((1, 2) =&gt; 1, (2, 10) =&gt; 2, (1, 10) =&gt; 3, (1, 55) =&gt; 4, (2, 55) =&gt; 5, (10, 55) =&gt; 6, (1, 46) =&gt; 7, (2, 46) =&gt; 8, (46, 55) =&gt; 9, (2, 11) =&gt; 10…), OrderedCollections.OrderedDict(1 =&gt; 1, 2 =&gt; 2, 10 =&gt; 3, 55 =&gt; 4, 46 =&gt; 5, 11 =&gt; 6, 56 =&gt; 7, 47 =&gt; 8, 3 =&gt; 9, 12 =&gt; 10…), OrderedCollections.OrderedDict{DataType, Int64}(Tetrahedron =&gt; 768), OrderedCollections.OrderedDict{String, Thunderbolt.VolumetricSubdomainDesriptor}(&quot;&quot; =&gt; Thunderbolt.VolumetricSubdomainDesriptor(OrderedCollections.OrderedDict{Type, OrderedCollections.OrderedSet{CellIndex}}(Tetrahedron =&gt; OrderedCollections.OrderedSet{CellIndex}(CellIndex[CellIndex(1), CellIndex(2), CellIndex(3), CellIndex(4), CellIndex(5), CellIndex(6), CellIndex(7), CellIndex(8), CellIndex(9), CellIndex(10)  …  CellIndex(759), CellIndex(760), CellIndex(761), CellIndex(762), CellIndex(763), CellIndex(764), CellIndex(765), CellIndex(766), CellIndex(767), CellIndex(768)])))), OrderedCollections.OrderedDict{String, Thunderbolt.SurfaceSubdomainDesriptor}(&quot;left&quot; =&gt; Thunderbolt.SurfaceSubdomainDesriptor(OrderedCollections.OrderedDict{Type, OrderedCollections.OrderedSet{FacetIndex}}(Tetrahedron =&gt; OrderedCollections.OrderedSet{FacetIndex}(FacetIndex[FacetIndex((1, 4)), FacetIndex((2, 2)), FacetIndex((49, 4)), FacetIndex((50, 2)), FacetIndex((97, 4)), FacetIndex((98, 2)), FacetIndex((145, 4)), FacetIndex((146, 2)), FacetIndex((193, 4)), FacetIndex((194, 2))  …  FacetIndex((529, 4)), FacetIndex((530, 2)), FacetIndex((577, 4)), FacetIndex((578, 2)), FacetIndex((625, 4)), FacetIndex((626, 2)), FacetIndex((673, 4)), FacetIndex((674, 2)), FacetIndex((721, 4)), FacetIndex((722, 2))]))), &quot;bottom&quot; =&gt; Thunderbolt.SurfaceSubdomainDesriptor(OrderedCollections.OrderedDict{Type, OrderedCollections.OrderedSet{FacetIndex}}(Tetrahedron =&gt; OrderedCollections.OrderedSet{FacetIndex}(FacetIndex[FacetIndex((1, 1)), FacetIndex((3, 1)), FacetIndex((7, 1)), FacetIndex((9, 1)), FacetIndex((13, 1)), FacetIndex((15, 1)), FacetIndex((19, 1)), FacetIndex((21, 1)), FacetIndex((25, 1)), FacetIndex((27, 1))  …  FacetIndex((163, 1)), FacetIndex((165, 1)), FacetIndex((169, 1)), FacetIndex((171, 1)), FacetIndex((175, 1)), FacetIndex((177, 1)), FacetIndex((181, 1)), FacetIndex((183, 1)), FacetIndex((187, 1)), FacetIndex((189, 1))]))), &quot;right&quot; =&gt; Thunderbolt.SurfaceSubdomainDesriptor(OrderedCollections.OrderedDict{Type, OrderedCollections.OrderedSet{FacetIndex}}(Tetrahedron =&gt; OrderedCollections.OrderedSet{FacetIndex}(FacetIndex[FacetIndex((46, 1)), FacetIndex((48, 1)), FacetIndex((94, 1)), FacetIndex((96, 1)), FacetIndex((142, 1)), FacetIndex((144, 1)), FacetIndex((190, 1)), FacetIndex((192, 1)), FacetIndex((238, 1)), FacetIndex((240, 1))  …  FacetIndex((574, 1)), FacetIndex((576, 1)), FacetIndex((622, 1)), FacetIndex((624, 1)), FacetIndex((670, 1)), FacetIndex((672, 1)), FacetIndex((718, 1)), FacetIndex((720, 1)), FacetIndex((766, 1)), FacetIndex((768, 1))]))), &quot;back&quot; =&gt; Thunderbolt.SurfaceSubdomainDesriptor(OrderedCollections.OrderedDict{Type, OrderedCollections.OrderedSet{FacetIndex}}(Tetrahedron =&gt; OrderedCollections.OrderedSet{FacetIndex}(FacetIndex[FacetIndex((147, 3)), FacetIndex((148, 3)), FacetIndex((153, 3)), FacetIndex((154, 3)), FacetIndex((159, 3)), FacetIndex((160, 3)), FacetIndex((165, 3)), FacetIndex((166, 3)), FacetIndex((171, 3)), FacetIndex((172, 3))  …  FacetIndex((741, 3)), FacetIndex((742, 3)), FacetIndex((747, 3)), FacetIndex((748, 3)), FacetIndex((753, 3)), FacetIndex((754, 3)), FacetIndex((759, 3)), FacetIndex((760, 3)), FacetIndex((765, 3)), FacetIndex((766, 3))]))), &quot;top&quot; =&gt; Thunderbolt.SurfaceSubdomainDesriptor(OrderedCollections.OrderedDict{Type, OrderedCollections.OrderedSet{FacetIndex}}(Tetrahedron =&gt; OrderedCollections.OrderedSet{FacetIndex}(FacetIndex[FacetIndex((581, 3)), FacetIndex((582, 3)), FacetIndex((587, 3)), FacetIndex((588, 3)), FacetIndex((593, 3)), FacetIndex((594, 3)), FacetIndex((599, 3)), FacetIndex((600, 3)), FacetIndex((605, 3)), FacetIndex((606, 3))  …  FacetIndex((743, 3)), FacetIndex((744, 3)), FacetIndex((749, 3)), FacetIndex((750, 3)), FacetIndex((755, 3)), FacetIndex((756, 3)), FacetIndex((761, 3)), FacetIndex((762, 3)), FacetIndex((767, 3)), FacetIndex((768, 3))]))), &quot;front&quot; =&gt; Thunderbolt.SurfaceSubdomainDesriptor(OrderedCollections.OrderedDict{Type, OrderedCollections.OrderedSet{FacetIndex}}(Tetrahedron =&gt; OrderedCollections.OrderedSet{FacetIndex}(FacetIndex[FacetIndex((2, 1)), FacetIndex((5, 1)), FacetIndex((8, 1)), FacetIndex((11, 1)), FacetIndex((14, 1)), FacetIndex((17, 1)), FacetIndex((20, 1)), FacetIndex((23, 1)), FacetIndex((26, 1)), FacetIndex((29, 1))  …  FacetIndex((596, 1)), FacetIndex((599, 1)), FacetIndex((602, 1)), FacetIndex((605, 1)), FacetIndex((608, 1)), FacetIndex((611, 1)), FacetIndex((614, 1)), FacetIndex((617, 1)), FacetIndex((620, 1)), FacetIndex((623, 1))])))), OrderedCollections.OrderedDict{String, Thunderbolt.InterfaceSubdomainDesriptor}()), 225)), Thunderbolt.NodalIntergridInterpolation{PointEvalHandler{Thunderbolt.SimpleMesh{3, Tetrahedron, Float64}, Float64}, DofHandler{3, Thunderbolt.SimpleMesh{3, Tetrahedron, Float64}}, DofHandler{3, Thunderbolt.SimpleMesh{3, Hexahedron, Float64}}}(PointEvalHandler{Thunderbolt.SimpleMesh{3, Tetrahedron, Float64}, Float64}(Thunderbolt.SimpleMesh{3, Tetrahedron, Float64}(Grid{3, Tetrahedron, Float64}(Tetrahedron[Tetrahedron((1, 2, 10, 55)), Tetrahedron((1, 46, 2, 55)), Tetrahedron((2, 11, 10, 55)), Tetrahedron((2, 56, 11, 55)), Tetrahedron((2, 46, 47, 55)), Tetrahedron((2, 47, 56, 55)), Tetrahedron((2, 3, 11, 56)), Tetrahedron((2, 47, 3, 56)), Tetrahedron((3, 12, 11, 56)), Tetrahedron((3, 57, 12, 56))  …  Tetrahedron((170, 179, 178, 223)), Tetrahedron((170, 224, 179, 223)), Tetrahedron((170, 214, 215, 223)), Tetrahedron((170, 215, 224, 223)), Tetrahedron((170, 171, 179, 224)), Tetrahedron((170, 215, 171, 224)), Tetrahedron((171, 180, 179, 224)), Tetrahedron((171, 225, 180, 224)), Tetrahedron((171, 215, 216, 224)), Tetrahedron((171, 216, 225, 224))], Node{3, Float64}[Node{3, Float64}([1.5, 1.5, 0.0]), Node{3, Float64}([2.0, 1.5, 0.0]), Node{3, Float64}([2.5, 1.5, 0.0]), Node{3, Float64}([3.0, 1.5, 0.0]), Node{3, Float64}([3.5, 1.5, 0.0]), Node{3, Float64}([4.0, 1.5, 0.0]), Node{3, Float64}([4.5, 1.5, 0.0]), Node{3, Float64}([5.0, 1.5, 0.0]), Node{3, Float64}([5.5, 1.5, 0.0]), Node{3, Float64}([1.5, 2.0, 0.0])  …  Node{3, Float64}([5.5, 3.0, 2.0]), Node{3, Float64}([1.5, 3.5, 2.0]), Node{3, Float64}([2.0, 3.5, 2.0]), Node{3, Float64}([2.5, 3.5, 2.0]), Node{3, Float64}([3.0, 3.5, 2.0]), Node{3, Float64}([3.5, 3.5, 2.0]), Node{3, Float64}([4.0, 3.5, 2.0]), Node{3, Float64}([4.5, 3.5, 2.0]), Node{3, Float64}([5.0, 3.5, 2.0]), Node{3, Float64}([5.5, 3.5, 2.0])], Dict{String, OrderedCollections.OrderedSet{Int64}}(), Dict{String, OrderedCollections.OrderedSet{Int64}}(), Dict{String, OrderedCollections.OrderedSet{FacetIndex}}(&quot;left&quot; =&gt; OrderedCollections.OrderedSet{FacetIndex}([FacetIndex((1, 4)), FacetIndex((2, 2)), FacetIndex((49, 4)), FacetIndex((50, 2)), FacetIndex((97, 4)), FacetIndex((98, 2)), FacetIndex((145, 4)), FacetIndex((146, 2)), FacetIndex((193, 4)), FacetIndex((194, 2))  …  FacetIndex((529, 4)), FacetIndex((530, 2)), FacetIndex((577, 4)), FacetIndex((578, 2)), FacetIndex((625, 4)), FacetIndex((626, 2)), FacetIndex((673, 4)), FacetIndex((674, 2)), FacetIndex((721, 4)), FacetIndex((722, 2))]), &quot;bottom&quot; =&gt; OrderedCollections.OrderedSet{FacetIndex}([FacetIndex((1, 1)), FacetIndex((3, 1)), FacetIndex((7, 1)), FacetIndex((9, 1)), FacetIndex((13, 1)), FacetIndex((15, 1)), FacetIndex((19, 1)), FacetIndex((21, 1)), FacetIndex((25, 1)), FacetIndex((27, 1))  …  FacetIndex((163, 1)), FacetIndex((165, 1)), FacetIndex((169, 1)), FacetIndex((171, 1)), FacetIndex((175, 1)), FacetIndex((177, 1)), FacetIndex((181, 1)), FacetIndex((183, 1)), FacetIndex((187, 1)), FacetIndex((189, 1))]), &quot;right&quot; =&gt; OrderedCollections.OrderedSet{FacetIndex}([FacetIndex((46, 1)), FacetIndex((48, 1)), FacetIndex((94, 1)), FacetIndex((96, 1)), FacetIndex((142, 1)), FacetIndex((144, 1)), FacetIndex((190, 1)), FacetIndex((192, 1)), FacetIndex((238, 1)), FacetIndex((240, 1))  …  FacetIndex((574, 1)), FacetIndex((576, 1)), FacetIndex((622, 1)), FacetIndex((624, 1)), FacetIndex((670, 1)), FacetIndex((672, 1)), FacetIndex((718, 1)), FacetIndex((720, 1)), FacetIndex((766, 1)), FacetIndex((768, 1))]), &quot;back&quot; =&gt; OrderedCollections.OrderedSet{FacetIndex}([FacetIndex((147, 3)), FacetIndex((148, 3)), FacetIndex((153, 3)), FacetIndex((154, 3)), FacetIndex((159, 3)), FacetIndex((160, 3)), FacetIndex((165, 3)), FacetIndex((166, 3)), FacetIndex((171, 3)), FacetIndex((172, 3))  …  FacetIndex((741, 3)), FacetIndex((742, 3)), FacetIndex((747, 3)), FacetIndex((748, 3)), FacetIndex((753, 3)), FacetIndex((754, 3)), FacetIndex((759, 3)), FacetIndex((760, 3)), FacetIndex((765, 3)), FacetIndex((766, 3))]), &quot;top&quot; =&gt; OrderedCollections.OrderedSet{FacetIndex}([FacetIndex((581, 3)), FacetIndex((582, 3)), FacetIndex((587, 3)), FacetIndex((588, 3)), FacetIndex((593, 3)), FacetIndex((594, 3)), FacetIndex((599, 3)), FacetIndex((600, 3)), FacetIndex((605, 3)), FacetIndex((606, 3))  …  FacetIndex((743, 3)), FacetIndex((744, 3)), FacetIndex((749, 3)), FacetIndex((750, 3)), FacetIndex((755, 3)), FacetIndex((756, 3)), FacetIndex((761, 3)), FacetIndex((762, 3)), FacetIndex((767, 3)), FacetIndex((768, 3))]), &quot;front&quot; =&gt; OrderedCollections.OrderedSet{FacetIndex}([FacetIndex((2, 1)), FacetIndex((5, 1)), FacetIndex((8, 1)), FacetIndex((11, 1)), FacetIndex((14, 1)), FacetIndex((17, 1)), FacetIndex((20, 1)), FacetIndex((23, 1)), FacetIndex((26, 1)), FacetIndex((29, 1))  …  FacetIndex((596, 1)), FacetIndex((599, 1)), FacetIndex((602, 1)), FacetIndex((605, 1)), FacetIndex((608, 1)), FacetIndex((611, 1)), FacetIndex((614, 1)), FacetIndex((617, 1)), FacetIndex((620, 1)), FacetIndex((623, 1))])), Dict{String, OrderedCollections.OrderedSet{VertexIndex}}()), OrderedCollections.OrderedDict((1, 2, 10) =&gt; 1, (1, 2, 55) =&gt; 2, (2, 10, 55) =&gt; 3, (1, 10, 55) =&gt; 4, (1, 2, 46) =&gt; 5, (1, 46, 55) =&gt; 6, (2, 46, 55) =&gt; 7, (2, 10, 11) =&gt; 8, (2, 11, 55) =&gt; 9, (10, 11, 55) =&gt; 10…), OrderedCollections.OrderedDict((1, 2) =&gt; 1, (2, 10) =&gt; 2, (1, 10) =&gt; 3, (1, 55) =&gt; 4, (2, 55) =&gt; 5, (10, 55) =&gt; 6, (1, 46) =&gt; 7, (2, 46) =&gt; 8, (46, 55) =&gt; 9, (2, 11) =&gt; 10…), OrderedCollections.OrderedDict(1 =&gt; 1, 2 =&gt; 2, 10 =&gt; 3, 55 =&gt; 4, 46 =&gt; 5, 11 =&gt; 6, 56 =&gt; 7, 47 =&gt; 8, 3 =&gt; 9, 12 =&gt; 10…), OrderedCollections.OrderedDict{DataType, Int64}(Tetrahedron =&gt; 768), OrderedCollections.OrderedDict{String, Thunderbolt.VolumetricSubdomainDesriptor}(&quot;&quot; =&gt; Thunderbolt.VolumetricSubdomainDesriptor(OrderedCollections.OrderedDict{Type, OrderedCollections.OrderedSet{CellIndex}}(Tetrahedron =&gt; OrderedCollections.OrderedSet{CellIndex}(CellIndex[CellIndex(1), CellIndex(2), CellIndex(3), CellIndex(4), CellIndex(5), CellIndex(6), CellIndex(7), CellIndex(8), CellIndex(9), CellIndex(10)  …  CellIndex(759), CellIndex(760), CellIndex(761), CellIndex(762), CellIndex(763), CellIndex(764), CellIndex(765), CellIndex(766), CellIndex(767), CellIndex(768)])))), OrderedCollections.OrderedDict{String, Thunderbolt.SurfaceSubdomainDesriptor}(&quot;left&quot; =&gt; Thunderbolt.SurfaceSubdomainDesriptor(OrderedCollections.OrderedDict{Type, OrderedCollections.OrderedSet{FacetIndex}}(Tetrahedron =&gt; OrderedCollections.OrderedSet{FacetIndex}(FacetIndex[FacetIndex((1, 4)), FacetIndex((2, 2)), FacetIndex((49, 4)), FacetIndex((50, 2)), FacetIndex((97, 4)), FacetIndex((98, 2)), FacetIndex((145, 4)), FacetIndex((146, 2)), FacetIndex((193, 4)), FacetIndex((194, 2))  …  FacetIndex((529, 4)), FacetIndex((530, 2)), FacetIndex((577, 4)), FacetIndex((578, 2)), FacetIndex((625, 4)), FacetIndex((626, 2)), FacetIndex((673, 4)), FacetIndex((674, 2)), FacetIndex((721, 4)), FacetIndex((722, 2))]))), &quot;bottom&quot; =&gt; Thunderbolt.SurfaceSubdomainDesriptor(OrderedCollections.OrderedDict{Type, OrderedCollections.OrderedSet{FacetIndex}}(Tetrahedron =&gt; OrderedCollections.OrderedSet{FacetIndex}(FacetIndex[FacetIndex((1, 1)), FacetIndex((3, 1)), FacetIndex((7, 1)), FacetIndex((9, 1)), FacetIndex((13, 1)), FacetIndex((15, 1)), FacetIndex((19, 1)), FacetIndex((21, 1)), FacetIndex((25, 1)), FacetIndex((27, 1))  …  FacetIndex((163, 1)), FacetIndex((165, 1)), FacetIndex((169, 1)), FacetIndex((171, 1)), FacetIndex((175, 1)), FacetIndex((177, 1)), FacetIndex((181, 1)), FacetIndex((183, 1)), FacetIndex((187, 1)), FacetIndex((189, 1))]))), &quot;right&quot; =&gt; Thunderbolt.SurfaceSubdomainDesriptor(OrderedCollections.OrderedDict{Type, OrderedCollections.OrderedSet{FacetIndex}}(Tetrahedron =&gt; OrderedCollections.OrderedSet{FacetIndex}(FacetIndex[FacetIndex((46, 1)), FacetIndex((48, 1)), FacetIndex((94, 1)), FacetIndex((96, 1)), FacetIndex((142, 1)), FacetIndex((144, 1)), FacetIndex((190, 1)), FacetIndex((192, 1)), FacetIndex((238, 1)), FacetIndex((240, 1))  …  FacetIndex((574, 1)), FacetIndex((576, 1)), FacetIndex((622, 1)), FacetIndex((624, 1)), FacetIndex((670, 1)), FacetIndex((672, 1)), FacetIndex((718, 1)), FacetIndex((720, 1)), FacetIndex((766, 1)), FacetIndex((768, 1))]))), &quot;back&quot; =&gt; Thunderbolt.SurfaceSubdomainDesriptor(OrderedCollections.OrderedDict{Type, OrderedCollections.OrderedSet{FacetIndex}}(Tetrahedron =&gt; OrderedCollections.OrderedSet{FacetIndex}(FacetIndex[FacetIndex((147, 3)), FacetIndex((148, 3)), FacetIndex((153, 3)), FacetIndex((154, 3)), FacetIndex((159, 3)), FacetIndex((160, 3)), FacetIndex((165, 3)), FacetIndex((166, 3)), FacetIndex((171, 3)), FacetIndex((172, 3))  …  FacetIndex((741, 3)), FacetIndex((742, 3)), FacetIndex((747, 3)), FacetIndex((748, 3)), FacetIndex((753, 3)), FacetIndex((754, 3)), FacetIndex((759, 3)), FacetIndex((760, 3)), FacetIndex((765, 3)), FacetIndex((766, 3))]))), &quot;top&quot; =&gt; Thunderbolt.SurfaceSubdomainDesriptor(OrderedCollections.OrderedDict{Type, OrderedCollections.OrderedSet{FacetIndex}}(Tetrahedron =&gt; OrderedCollections.OrderedSet{FacetIndex}(FacetIndex[FacetIndex((581, 3)), FacetIndex((582, 3)), FacetIndex((587, 3)), FacetIndex((588, 3)), FacetIndex((593, 3)), FacetIndex((594, 3)), FacetIndex((599, 3)), FacetIndex((600, 3)), FacetIndex((605, 3)), FacetIndex((606, 3))  …  FacetIndex((743, 3)), FacetIndex((744, 3)), FacetIndex((749, 3)), FacetIndex((750, 3)), FacetIndex((755, 3)), FacetIndex((756, 3)), FacetIndex((761, 3)), FacetIndex((762, 3)), FacetIndex((767, 3)), FacetIndex((768, 3))]))), &quot;front&quot; =&gt; Thunderbolt.SurfaceSubdomainDesriptor(OrderedCollections.OrderedDict{Type, OrderedCollections.OrderedSet{FacetIndex}}(Tetrahedron =&gt; OrderedCollections.OrderedSet{FacetIndex}(FacetIndex[FacetIndex((2, 1)), FacetIndex((5, 1)), FacetIndex((8, 1)), FacetIndex((11, 1)), FacetIndex((14, 1)), FacetIndex((17, 1)), FacetIndex((20, 1)), FacetIndex((23, 1)), FacetIndex((26, 1)), FacetIndex((29, 1))  …  FacetIndex((596, 1)), FacetIndex((599, 1)), FacetIndex((602, 1)), FacetIndex((605, 1)), FacetIndex((608, 1)), FacetIndex((611, 1)), FacetIndex((614, 1)), FacetIndex((617, 1)), FacetIndex((620, 1)), FacetIndex((623, 1))])))), OrderedCollections.OrderedDict{String, Thunderbolt.InterfaceSubdomainDesriptor}()), Union{Nothing, Int64}[nothing, nothing, nothing, nothing, nothing, nothing, nothing, nothing, nothing, nothing  …  nothing, nothing, nothing, nothing, nothing, nothing, nothing, nothing, nothing, nothing], Union{Nothing, Vec{1, Float64}, Vec{2, Float64}, Vec{3, Float64}}[nothing, nothing, nothing, nothing, nothing, nothing, nothing, nothing, nothing, nothing  …  nothing, nothing, nothing, nothing, nothing, nothing, nothing, nothing, nothing, nothing]), DofHandler{3, Thunderbolt.SimpleMesh{3, Tetrahedron, Float64}}(SubDofHandler{DofHandler{3, Thunderbolt.SimpleMesh{3, Tetrahedron, Float64}}}[SubDofHandler{DofHandler{3, Thunderbolt.SimpleMesh{3, Tetrahedron, Float64}}}(DofHandler{3, Thunderbolt.SimpleMesh{3, Tetrahedron, Float64}}(#= circular reference @-3 =#), OrderedCollections.OrderedSet{Int64}([1, 2, 3, 4, 5, 6, 7, 8, 9, 10  …  759, 760, 761, 762, 763, 764, 765, 766, 767, 768]), [:φₘ], Interpolation[Lagrange{RefTetrahedron, 1}()], Int64[], 4)], [:φₘ], [1, 2, 3, 4, 1, 5, 2, 4, 2, 6  …  180, 224, 171, 215, 216, 224, 171, 216, 225, 224], [1, 5, 9, 13, 17, 21, 25, 29, 33, 37  …  3033, 3037, 3041, 3045, 3049, 3053, 3057, 3061, 3065, 3069], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1  …  1, 1, 1, 1, 1, 1, 1, 1, 1, 1], true, Thunderbolt.SimpleMesh{3, Tetrahedron, Float64}(Grid{3, Tetrahedron, Float64}(Tetrahedron[Tetrahedron((1, 2, 10, 55)), Tetrahedron((1, 46, 2, 55)), Tetrahedron((2, 11, 10, 55)), Tetrahedron((2, 56, 11, 55)), Tetrahedron((2, 46, 47, 55)), Tetrahedron((2, 47, 56, 55)), Tetrahedron((2, 3, 11, 56)), Tetrahedron((2, 47, 3, 56)), Tetrahedron((3, 12, 11, 56)), Tetrahedron((3, 57, 12, 56))  …  Tetrahedron((170, 179, 178, 223)), Tetrahedron((170, 224, 179, 223)), Tetrahedron((170, 214, 215, 223)), Tetrahedron((170, 215, 224, 223)), Tetrahedron((170, 171, 179, 224)), Tetrahedron((170, 215, 171, 224)), Tetrahedron((171, 180, 179, 224)), Tetrahedron((171, 225, 180, 224)), Tetrahedron((171, 215, 216, 224)), Tetrahedron((171, 216, 225, 224))], Node{3, Float64}[Node{3, Float64}([1.5, 1.5, 0.0]), Node{3, Float64}([2.0, 1.5, 0.0]), Node{3, Float64}([2.5, 1.5, 0.0]), Node{3, Float64}([3.0, 1.5, 0.0]), Node{3, Float64}([3.5, 1.5, 0.0]), Node{3, Float64}([4.0, 1.5, 0.0]), Node{3, Float64}([4.5, 1.5, 0.0]), Node{3, Float64}([5.0, 1.5, 0.0]), Node{3, Float64}([5.5, 1.5, 0.0]), Node{3, Float64}([1.5, 2.0, 0.0])  …  Node{3, Float64}([5.5, 3.0, 2.0]), Node{3, Float64}([1.5, 3.5, 2.0]), Node{3, Float64}([2.0, 3.5, 2.0]), Node{3, Float64}([2.5, 3.5, 2.0]), Node{3, Float64}([3.0, 3.5, 2.0]), Node{3, Float64}([3.5, 3.5, 2.0]), Node{3, Float64}([4.0, 3.5, 2.0]), Node{3, Float64}([4.5, 3.5, 2.0]), Node{3, Float64}([5.0, 3.5, 2.0]), Node{3, Float64}([5.5, 3.5, 2.0])], Dict{String, OrderedCollections.OrderedSet{Int64}}(), Dict{String, OrderedCollections.OrderedSet{Int64}}(), Dict{String, OrderedCollections.OrderedSet{FacetIndex}}(&quot;left&quot; =&gt; OrderedCollections.OrderedSet{FacetIndex}([FacetIndex((1, 4)), FacetIndex((2, 2)), FacetIndex((49, 4)), FacetIndex((50, 2)), FacetIndex((97, 4)), FacetIndex((98, 2)), FacetIndex((145, 4)), FacetIndex((146, 2)), FacetIndex((193, 4)), FacetIndex((194, 2))  …  FacetIndex((529, 4)), FacetIndex((530, 2)), FacetIndex((577, 4)), FacetIndex((578, 2)), FacetIndex((625, 4)), FacetIndex((626, 2)), FacetIndex((673, 4)), FacetIndex((674, 2)), FacetIndex((721, 4)), FacetIndex((722, 2))]), &quot;bottom&quot; =&gt; OrderedCollections.OrderedSet{FacetIndex}([FacetIndex((1, 1)), FacetIndex((3, 1)), FacetIndex((7, 1)), FacetIndex((9, 1)), FacetIndex((13, 1)), FacetIndex((15, 1)), FacetIndex((19, 1)), FacetIndex((21, 1)), FacetIndex((25, 1)), FacetIndex((27, 1))  …  FacetIndex((163, 1)), FacetIndex((165, 1)), FacetIndex((169, 1)), FacetIndex((171, 1)), FacetIndex((175, 1)), FacetIndex((177, 1)), FacetIndex((181, 1)), FacetIndex((183, 1)), FacetIndex((187, 1)), FacetIndex((189, 1))]), &quot;right&quot; =&gt; OrderedCollections.OrderedSet{FacetIndex}([FacetIndex((46, 1)), FacetIndex((48, 1)), FacetIndex((94, 1)), FacetIndex((96, 1)), FacetIndex((142, 1)), FacetIndex((144, 1)), FacetIndex((190, 1)), FacetIndex((192, 1)), FacetIndex((238, 1)), FacetIndex((240, 1))  …  FacetIndex((574, 1)), FacetIndex((576, 1)), FacetIndex((622, 1)), FacetIndex((624, 1)), FacetIndex((670, 1)), FacetIndex((672, 1)), FacetIndex((718, 1)), FacetIndex((720, 1)), FacetIndex((766, 1)), FacetIndex((768, 1))]), &quot;back&quot; =&gt; OrderedCollections.OrderedSet{FacetIndex}([FacetIndex((147, 3)), FacetIndex((148, 3)), FacetIndex((153, 3)), FacetIndex((154, 3)), FacetIndex((159, 3)), FacetIndex((160, 3)), FacetIndex((165, 3)), FacetIndex((166, 3)), FacetIndex((171, 3)), FacetIndex((172, 3))  …  FacetIndex((741, 3)), FacetIndex((742, 3)), FacetIndex((747, 3)), FacetIndex((748, 3)), FacetIndex((753, 3)), FacetIndex((754, 3)), FacetIndex((759, 3)), FacetIndex((760, 3)), FacetIndex((765, 3)), FacetIndex((766, 3))]), &quot;top&quot; =&gt; OrderedCollections.OrderedSet{FacetIndex}([FacetIndex((581, 3)), FacetIndex((582, 3)), FacetIndex((587, 3)), FacetIndex((588, 3)), FacetIndex((593, 3)), FacetIndex((594, 3)), FacetIndex((599, 3)), FacetIndex((600, 3)), FacetIndex((605, 3)), FacetIndex((606, 3))  …  FacetIndex((743, 3)), FacetIndex((744, 3)), FacetIndex((749, 3)), FacetIndex((750, 3)), FacetIndex((755, 3)), FacetIndex((756, 3)), FacetIndex((761, 3)), FacetIndex((762, 3)), FacetIndex((767, 3)), FacetIndex((768, 3))]), &quot;front&quot; =&gt; OrderedCollections.OrderedSet{FacetIndex}([FacetIndex((2, 1)), FacetIndex((5, 1)), FacetIndex((8, 1)), FacetIndex((11, 1)), FacetIndex((14, 1)), FacetIndex((17, 1)), FacetIndex((20, 1)), FacetIndex((23, 1)), FacetIndex((26, 1)), FacetIndex((29, 1))  …  FacetIndex((596, 1)), FacetIndex((599, 1)), FacetIndex((602, 1)), FacetIndex((605, 1)), FacetIndex((608, 1)), FacetIndex((611, 1)), FacetIndex((614, 1)), FacetIndex((617, 1)), FacetIndex((620, 1)), FacetIndex((623, 1))])), Dict{String, OrderedCollections.OrderedSet{VertexIndex}}()), OrderedCollections.OrderedDict((1, 2, 10) =&gt; 1, (1, 2, 55) =&gt; 2, (2, 10, 55) =&gt; 3, (1, 10, 55) =&gt; 4, (1, 2, 46) =&gt; 5, (1, 46, 55) =&gt; 6, (2, 46, 55) =&gt; 7, (2, 10, 11) =&gt; 8, (2, 11, 55) =&gt; 9, (10, 11, 55) =&gt; 10…), OrderedCollections.OrderedDict((1, 2) =&gt; 1, (2, 10) =&gt; 2, (1, 10) =&gt; 3, (1, 55) =&gt; 4, (2, 55) =&gt; 5, (10, 55) =&gt; 6, (1, 46) =&gt; 7, (2, 46) =&gt; 8, (46, 55) =&gt; 9, (2, 11) =&gt; 10…), OrderedCollections.OrderedDict(1 =&gt; 1, 2 =&gt; 2, 10 =&gt; 3, 55 =&gt; 4, 46 =&gt; 5, 11 =&gt; 6, 56 =&gt; 7, 47 =&gt; 8, 3 =&gt; 9, 12 =&gt; 10…), OrderedCollections.OrderedDict{DataType, Int64}(Tetrahedron =&gt; 768), OrderedCollections.OrderedDict{String, Thunderbolt.VolumetricSubdomainDesriptor}(&quot;&quot; =&gt; Thunderbolt.VolumetricSubdomainDesriptor(OrderedCollections.OrderedDict{Type, OrderedCollections.OrderedSet{CellIndex}}(Tetrahedron =&gt; OrderedCollections.OrderedSet{CellIndex}(CellIndex[CellIndex(1), CellIndex(2), CellIndex(3), CellIndex(4), CellIndex(5), CellIndex(6), CellIndex(7), CellIndex(8), CellIndex(9), CellIndex(10)  …  CellIndex(759), CellIndex(760), CellIndex(761), CellIndex(762), CellIndex(763), CellIndex(764), CellIndex(765), CellIndex(766), CellIndex(767), CellIndex(768)])))), OrderedCollections.OrderedDict{String, Thunderbolt.SurfaceSubdomainDesriptor}(&quot;left&quot; =&gt; Thunderbolt.SurfaceSubdomainDesriptor(OrderedCollections.OrderedDict{Type, OrderedCollections.OrderedSet{FacetIndex}}(Tetrahedron =&gt; OrderedCollections.OrderedSet{FacetIndex}(FacetIndex[FacetIndex((1, 4)), FacetIndex((2, 2)), FacetIndex((49, 4)), FacetIndex((50, 2)), FacetIndex((97, 4)), FacetIndex((98, 2)), FacetIndex((145, 4)), FacetIndex((146, 2)), FacetIndex((193, 4)), FacetIndex((194, 2))  …  FacetIndex((529, 4)), FacetIndex((530, 2)), FacetIndex((577, 4)), FacetIndex((578, 2)), FacetIndex((625, 4)), FacetIndex((626, 2)), FacetIndex((673, 4)), FacetIndex((674, 2)), FacetIndex((721, 4)), FacetIndex((722, 2))]))), &quot;bottom&quot; =&gt; Thunderbolt.SurfaceSubdomainDesriptor(OrderedCollections.OrderedDict{Type, OrderedCollections.OrderedSet{FacetIndex}}(Tetrahedron =&gt; OrderedCollections.OrderedSet{FacetIndex}(FacetIndex[FacetIndex((1, 1)), FacetIndex((3, 1)), FacetIndex((7, 1)), FacetIndex((9, 1)), FacetIndex((13, 1)), FacetIndex((15, 1)), FacetIndex((19, 1)), FacetIndex((21, 1)), FacetIndex((25, 1)), FacetIndex((27, 1))  …  FacetIndex((163, 1)), FacetIndex((165, 1)), FacetIndex((169, 1)), FacetIndex((171, 1)), FacetIndex((175, 1)), FacetIndex((177, 1)), FacetIndex((181, 1)), FacetIndex((183, 1)), FacetIndex((187, 1)), FacetIndex((189, 1))]))), &quot;right&quot; =&gt; Thunderbolt.SurfaceSubdomainDesriptor(OrderedCollections.OrderedDict{Type, OrderedCollections.OrderedSet{FacetIndex}}(Tetrahedron =&gt; OrderedCollections.OrderedSet{FacetIndex}(FacetIndex[FacetIndex((46, 1)), FacetIndex((48, 1)), FacetIndex((94, 1)), FacetIndex((96, 1)), FacetIndex((142, 1)), FacetIndex((144, 1)), FacetIndex((190, 1)), FacetIndex((192, 1)), FacetIndex((238, 1)), FacetIndex((240, 1))  …  FacetIndex((574, 1)), FacetIndex((576, 1)), FacetIndex((622, 1)), FacetIndex((624, 1)), FacetIndex((670, 1)), FacetIndex((672, 1)), FacetIndex((718, 1)), FacetIndex((720, 1)), FacetIndex((766, 1)), FacetIndex((768, 1))]))), &quot;back&quot; =&gt; Thunderbolt.SurfaceSubdomainDesriptor(OrderedCollections.OrderedDict{Type, OrderedCollections.OrderedSet{FacetIndex}}(Tetrahedron =&gt; OrderedCollections.OrderedSet{FacetIndex}(FacetIndex[FacetIndex((147, 3)), FacetIndex((148, 3)), FacetIndex((153, 3)), FacetIndex((154, 3)), FacetIndex((159, 3)), FacetIndex((160, 3)), FacetIndex((165, 3)), FacetIndex((166, 3)), FacetIndex((171, 3)), FacetIndex((172, 3))  …  FacetIndex((741, 3)), FacetIndex((742, 3)), FacetIndex((747, 3)), FacetIndex((748, 3)), FacetIndex((753, 3)), FacetIndex((754, 3)), FacetIndex((759, 3)), FacetIndex((760, 3)), FacetIndex((765, 3)), FacetIndex((766, 3))]))), &quot;top&quot; =&gt; Thunderbolt.SurfaceSubdomainDesriptor(OrderedCollections.OrderedDict{Type, OrderedCollections.OrderedSet{FacetIndex}}(Tetrahedron =&gt; OrderedCollections.OrderedSet{FacetIndex}(FacetIndex[FacetIndex((581, 3)), FacetIndex((582, 3)), FacetIndex((587, 3)), FacetIndex((588, 3)), FacetIndex((593, 3)), FacetIndex((594, 3)), FacetIndex((599, 3)), FacetIndex((600, 3)), FacetIndex((605, 3)), FacetIndex((606, 3))  …  FacetIndex((743, 3)), FacetIndex((744, 3)), FacetIndex((749, 3)), FacetIndex((750, 3)), FacetIndex((755, 3)), FacetIndex((756, 3)), FacetIndex((761, 3)), FacetIndex((762, 3)), FacetIndex((767, 3)), FacetIndex((768, 3))]))), &quot;front&quot; =&gt; Thunderbolt.SurfaceSubdomainDesriptor(OrderedCollections.OrderedDict{Type, OrderedCollections.OrderedSet{FacetIndex}}(Tetrahedron =&gt; OrderedCollections.OrderedSet{FacetIndex}(FacetIndex[FacetIndex((2, 1)), FacetIndex((5, 1)), FacetIndex((8, 1)), FacetIndex((11, 1)), FacetIndex((14, 1)), FacetIndex((17, 1)), FacetIndex((20, 1)), FacetIndex((23, 1)), FacetIndex((26, 1)), FacetIndex((29, 1))  …  FacetIndex((596, 1)), FacetIndex((599, 1)), FacetIndex((602, 1)), FacetIndex((605, 1)), FacetIndex((608, 1)), FacetIndex((611, 1)), FacetIndex((614, 1)), FacetIndex((617, 1)), FacetIndex((620, 1)), FacetIndex((623, 1))])))), OrderedCollections.OrderedDict{String, Thunderbolt.InterfaceSubdomainDesriptor}()), 225), DofHandler{3, Thunderbolt.SimpleMesh{3, Hexahedron, Float64}}(SubDofHandler{DofHandler{3, Thunderbolt.SimpleMesh{3, Hexahedron, Float64}}}[SubDofHandler{DofHandler{3, Thunderbolt.SimpleMesh{3, Hexahedron, Float64}}}(DofHandler{3, Thunderbolt.SimpleMesh{3, Hexahedron, Float64}}(#= circular reference @-3 =#), OrderedCollections.OrderedSet{Int64}([1, 2, 3, 4, 5, 6, 7, 8, 9, 10  …  971, 972, 973, 974, 975, 976, 977, 978, 979, 980]), [:Z], Interpolation[Lagrange{RefHexahedron, 1}()], Int64[], 8)], [:Z], [1, 2, 3, 4, 5, 6, 7, 8, 2, 9  …  1319, 1318, 1139, 1140, 1155, 1154, 1304, 1305, 1320, 1319], [1, 9, 17, 25, 33, 41, 49, 57, 65, 73  …  7761, 7769, 7777, 7785, 7793, 7801, 7809, 7817, 7825, 7833], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1  …  1, 1, 1, 1, 1, 1, 1, 1, 1, 1], true, Thunderbolt.SimpleMesh{3, Hexahedron, Float64}(Grid{3, Hexahedron, Float64}(Hexahedron[Hexahedron((1, 2, 17, 16, 166, 167, 182, 181)), Hexahedron((2, 3, 18, 17, 167, 168, 183, 182)), Hexahedron((3, 4, 19, 18, 168, 169, 184, 183)), Hexahedron((4, 5, 20, 19, 169, 170, 185, 184)), Hexahedron((5, 6, 21, 20, 170, 171, 186, 185)), Hexahedron((6, 7, 22, 21, 171, 172, 187, 186)), Hexahedron((7, 8, 23, 22, 172, 173, 188, 187)), Hexahedron((8, 9, 24, 23, 173, 174, 189, 188)), Hexahedron((9, 10, 25, 24, 174, 175, 190, 189)), Hexahedron((10, 11, 26, 25, 175, 176, 191, 190))  …  Hexahedron((1130, 1131, 1146, 1145, 1295, 1296, 1311, 1310)), Hexahedron((1131, 1132, 1147, 1146, 1296, 1297, 1312, 1311)), Hexahedron((1132, 1133, 1148, 1147, 1297, 1298, 1313, 1312)), Hexahedron((1133, 1134, 1149, 1148, 1298, 1299, 1314, 1313)), Hexahedron((1134, 1135, 1150, 1149, 1299, 1300, 1315, 1314)), Hexahedron((1135, 1136, 1151, 1150, 1300, 1301, 1316, 1315)), Hexahedron((1136, 1137, 1152, 1151, 1301, 1302, 1317, 1316)), Hexahedron((1137, 1138, 1153, 1152, 1302, 1303, 1318, 1317)), Hexahedron((1138, 1139, 1154, 1153, 1303, 1304, 1319, 1318)), Hexahedron((1139, 1140, 1155, 1154, 1304, 1305, 1320, 1319))], Node{3, Float64}[Node{3, Float64}([0.0, 0.0, 0.0]), Node{3, Float64}([0.5, 0.0, 0.0]), Node{3, Float64}([1.0, 0.0, 0.0]), Node{3, Float64}([1.5, 0.0, 0.0]), Node{3, Float64}([2.0, 0.0, 0.0]), Node{3, Float64}([2.5, 0.0, 0.0]), Node{3, Float64}([3.0, 0.0, 0.0]), Node{3, Float64}([3.5, 0.0, 0.0]), Node{3, Float64}([4.0, 0.0, 0.0]), Node{3, Float64}([4.5, 0.0, 0.0])  …  Node{3, Float64}([2.5, 5.0, 3.5]), Node{3, Float64}([3.0, 5.0, 3.5]), Node{3, Float64}([3.5, 5.0, 3.5]), Node{3, Float64}([4.0, 5.0, 3.5]), Node{3, Float64}([4.5, 5.0, 3.5]), Node{3, Float64}([5.0, 5.0, 3.5]), Node{3, Float64}([5.5, 5.0, 3.5]), Node{3, Float64}([6.0, 5.0, 3.5]), Node{3, Float64}([6.5, 5.0, 3.5]), Node{3, Float64}([7.0, 5.0, 3.5])], Dict{String, OrderedCollections.OrderedSet{Int64}}(), Dict{String, OrderedCollections.OrderedSet{Int64}}(), Dict{String, OrderedCollections.OrderedSet{FacetIndex}}(&quot;left&quot; =&gt; OrderedCollections.OrderedSet{FacetIndex}([FacetIndex((1, 5)), FacetIndex((15, 5)), FacetIndex((29, 5)), FacetIndex((43, 5)), FacetIndex((57, 5)), FacetIndex((71, 5)), FacetIndex((85, 5)), FacetIndex((99, 5)), FacetIndex((113, 5)), FacetIndex((127, 5))  …  FacetIndex((841, 5)), FacetIndex((855, 5)), FacetIndex((869, 5)), FacetIndex((883, 5)), FacetIndex((897, 5)), FacetIndex((911, 5)), FacetIndex((925, 5)), FacetIndex((939, 5)), FacetIndex((953, 5)), FacetIndex((967, 5))]), &quot;bottom&quot; =&gt; OrderedCollections.OrderedSet{FacetIndex}([FacetIndex((1, 1)), FacetIndex((2, 1)), FacetIndex((3, 1)), FacetIndex((4, 1)), FacetIndex((5, 1)), FacetIndex((6, 1)), FacetIndex((7, 1)), FacetIndex((8, 1)), FacetIndex((9, 1)), FacetIndex((10, 1))  …  FacetIndex((131, 1)), FacetIndex((132, 1)), FacetIndex((133, 1)), FacetIndex((134, 1)), FacetIndex((135, 1)), FacetIndex((136, 1)), FacetIndex((137, 1)), FacetIndex((138, 1)), FacetIndex((139, 1)), FacetIndex((140, 1))]), &quot;right&quot; =&gt; OrderedCollections.OrderedSet{FacetIndex}([FacetIndex((14, 3)), FacetIndex((28, 3)), FacetIndex((42, 3)), FacetIndex((56, 3)), FacetIndex((70, 3)), FacetIndex((84, 3)), FacetIndex((98, 3)), FacetIndex((112, 3)), FacetIndex((126, 3)), FacetIndex((140, 3))  …  FacetIndex((854, 3)), FacetIndex((868, 3)), FacetIndex((882, 3)), FacetIndex((896, 3)), FacetIndex((910, 3)), FacetIndex((924, 3)), FacetIndex((938, 3)), FacetIndex((952, 3)), FacetIndex((966, 3)), FacetIndex((980, 3))]), &quot;back&quot; =&gt; OrderedCollections.OrderedSet{FacetIndex}([FacetIndex((127, 4)), FacetIndex((128, 4)), FacetIndex((129, 4)), FacetIndex((130, 4)), FacetIndex((131, 4)), FacetIndex((132, 4)), FacetIndex((133, 4)), FacetIndex((134, 4)), FacetIndex((135, 4)), FacetIndex((136, 4))  …  FacetIndex((971, 4)), FacetIndex((972, 4)), FacetIndex((973, 4)), FacetIndex((974, 4)), FacetIndex((975, 4)), FacetIndex((976, 4)), FacetIndex((977, 4)), FacetIndex((978, 4)), FacetIndex((979, 4)), FacetIndex((980, 4))]), &quot;top&quot; =&gt; OrderedCollections.OrderedSet{FacetIndex}([FacetIndex((841, 6)), FacetIndex((842, 6)), FacetIndex((843, 6)), FacetIndex((844, 6)), FacetIndex((845, 6)), FacetIndex((846, 6)), FacetIndex((847, 6)), FacetIndex((848, 6)), FacetIndex((849, 6)), FacetIndex((850, 6))  …  FacetIndex((971, 6)), FacetIndex((972, 6)), FacetIndex((973, 6)), FacetIndex((974, 6)), FacetIndex((975, 6)), FacetIndex((976, 6)), FacetIndex((977, 6)), FacetIndex((978, 6)), FacetIndex((979, 6)), FacetIndex((980, 6))]), &quot;front&quot; =&gt; OrderedCollections.OrderedSet{FacetIndex}([FacetIndex((1, 2)), FacetIndex((2, 2)), FacetIndex((3, 2)), FacetIndex((4, 2)), FacetIndex((5, 2)), FacetIndex((6, 2)), FacetIndex((7, 2)), FacetIndex((8, 2)), FacetIndex((9, 2)), FacetIndex((10, 2))  …  FacetIndex((845, 2)), FacetIndex((846, 2)), FacetIndex((847, 2)), FacetIndex((848, 2)), FacetIndex((849, 2)), FacetIndex((850, 2)), FacetIndex((851, 2)), FacetIndex((852, 2)), FacetIndex((853, 2)), FacetIndex((854, 2))])), Dict{String, OrderedCollections.OrderedSet{VertexIndex}}()), OrderedCollections.OrderedDict((1, 2, 16) =&gt; 1, (1, 2, 166) =&gt; 2, (2, 17, 167) =&gt; 3, (16, 17, 181) =&gt; 4, (1, 16, 166) =&gt; 5, (166, 167, 181) =&gt; 6, (2, 3, 17) =&gt; 7, (2, 3, 167) =&gt; 8, (3, 18, 168) =&gt; 9, (17, 18, 182) =&gt; 10…), OrderedCollections.OrderedDict((1, 2) =&gt; 1, (2, 17) =&gt; 2, (16, 17) =&gt; 3, (1, 16) =&gt; 4, (166, 167) =&gt; 5, (167, 182) =&gt; 6, (181, 182) =&gt; 7, (166, 181) =&gt; 8, (1, 166) =&gt; 9, (2, 167) =&gt; 10…), OrderedCollections.OrderedDict(1 =&gt; 1, 2 =&gt; 2, 17 =&gt; 3, 16 =&gt; 4, 166 =&gt; 5, 167 =&gt; 6, 182 =&gt; 7, 181 =&gt; 8, 3 =&gt; 9, 18 =&gt; 10…), OrderedCollections.OrderedDict{DataType, Int64}(Hexahedron =&gt; 980), OrderedCollections.OrderedDict{String, Thunderbolt.VolumetricSubdomainDesriptor}(&quot;&quot; =&gt; Thunderbolt.VolumetricSubdomainDesriptor(OrderedCollections.OrderedDict{Type, OrderedCollections.OrderedSet{CellIndex}}(Hexahedron =&gt; OrderedCollections.OrderedSet{CellIndex}(CellIndex[CellIndex(1), CellIndex(2), CellIndex(3), CellIndex(4), CellIndex(5), CellIndex(6), CellIndex(7), CellIndex(8), CellIndex(9), CellIndex(10)  …  CellIndex(971), CellIndex(972), CellIndex(973), CellIndex(974), CellIndex(975), CellIndex(976), CellIndex(977), CellIndex(978), CellIndex(979), CellIndex(980)])))), OrderedCollections.OrderedDict{String, Thunderbolt.SurfaceSubdomainDesriptor}(&quot;left&quot; =&gt; Thunderbolt.SurfaceSubdomainDesriptor(OrderedCollections.OrderedDict{Type, OrderedCollections.OrderedSet{FacetIndex}}(Hexahedron =&gt; OrderedCollections.OrderedSet{FacetIndex}(FacetIndex[FacetIndex((1, 5)), FacetIndex((15, 5)), FacetIndex((29, 5)), FacetIndex((43, 5)), FacetIndex((57, 5)), FacetIndex((71, 5)), FacetIndex((85, 5)), FacetIndex((99, 5)), FacetIndex((113, 5)), FacetIndex((127, 5))  …  FacetIndex((841, 5)), FacetIndex((855, 5)), FacetIndex((869, 5)), FacetIndex((883, 5)), FacetIndex((897, 5)), FacetIndex((911, 5)), FacetIndex((925, 5)), FacetIndex((939, 5)), FacetIndex((953, 5)), FacetIndex((967, 5))]))), &quot;bottom&quot; =&gt; Thunderbolt.SurfaceSubdomainDesriptor(OrderedCollections.OrderedDict{Type, OrderedCollections.OrderedSet{FacetIndex}}(Hexahedron =&gt; OrderedCollections.OrderedSet{FacetIndex}(FacetIndex[FacetIndex((1, 1)), FacetIndex((2, 1)), FacetIndex((3, 1)), FacetIndex((4, 1)), FacetIndex((5, 1)), FacetIndex((6, 1)), FacetIndex((7, 1)), FacetIndex((8, 1)), FacetIndex((9, 1)), FacetIndex((10, 1))  …  FacetIndex((131, 1)), FacetIndex((132, 1)), FacetIndex((133, 1)), FacetIndex((134, 1)), FacetIndex((135, 1)), FacetIndex((136, 1)), FacetIndex((137, 1)), FacetIndex((138, 1)), FacetIndex((139, 1)), FacetIndex((140, 1))]))), &quot;right&quot; =&gt; Thunderbolt.SurfaceSubdomainDesriptor(OrderedCollections.OrderedDict{Type, OrderedCollections.OrderedSet{FacetIndex}}(Hexahedron =&gt; OrderedCollections.OrderedSet{FacetIndex}(FacetIndex[FacetIndex((14, 3)), FacetIndex((28, 3)), FacetIndex((42, 3)), FacetIndex((56, 3)), FacetIndex((70, 3)), FacetIndex((84, 3)), FacetIndex((98, 3)), FacetIndex((112, 3)), FacetIndex((126, 3)), FacetIndex((140, 3))  …  FacetIndex((854, 3)), FacetIndex((868, 3)), FacetIndex((882, 3)), FacetIndex((896, 3)), FacetIndex((910, 3)), FacetIndex((924, 3)), FacetIndex((938, 3)), FacetIndex((952, 3)), FacetIndex((966, 3)), FacetIndex((980, 3))]))), &quot;back&quot; =&gt; Thunderbolt.SurfaceSubdomainDesriptor(OrderedCollections.OrderedDict{Type, OrderedCollections.OrderedSet{FacetIndex}}(Hexahedron =&gt; OrderedCollections.OrderedSet{FacetIndex}(FacetIndex[FacetIndex((127, 4)), FacetIndex((128, 4)), FacetIndex((129, 4)), FacetIndex((130, 4)), FacetIndex((131, 4)), FacetIndex((132, 4)), FacetIndex((133, 4)), FacetIndex((134, 4)), FacetIndex((135, 4)), FacetIndex((136, 4))  …  FacetIndex((971, 4)), FacetIndex((972, 4)), FacetIndex((973, 4)), FacetIndex((974, 4)), FacetIndex((975, 4)), FacetIndex((976, 4)), FacetIndex((977, 4)), FacetIndex((978, 4)), FacetIndex((979, 4)), FacetIndex((980, 4))]))), &quot;top&quot; =&gt; Thunderbolt.SurfaceSubdomainDesriptor(OrderedCollections.OrderedDict{Type, OrderedCollections.OrderedSet{FacetIndex}}(Hexahedron =&gt; OrderedCollections.OrderedSet{FacetIndex}(FacetIndex[FacetIndex((841, 6)), FacetIndex((842, 6)), FacetIndex((843, 6)), FacetIndex((844, 6)), FacetIndex((845, 6)), FacetIndex((846, 6)), FacetIndex((847, 6)), FacetIndex((848, 6)), FacetIndex((849, 6)), FacetIndex((850, 6))  …  FacetIndex((971, 6)), FacetIndex((972, 6)), FacetIndex((973, 6)), FacetIndex((974, 6)), FacetIndex((975, 6)), FacetIndex((976, 6)), FacetIndex((977, 6)), FacetIndex((978, 6)), FacetIndex((979, 6)), FacetIndex((980, 6))]))), &quot;front&quot; =&gt; Thunderbolt.SurfaceSubdomainDesriptor(OrderedCollections.OrderedDict{Type, OrderedCollections.OrderedSet{FacetIndex}}(Hexahedron =&gt; OrderedCollections.OrderedSet{FacetIndex}(FacetIndex[FacetIndex((1, 2)), FacetIndex((2, 2)), FacetIndex((3, 2)), FacetIndex((4, 2)), FacetIndex((5, 2)), FacetIndex((6, 2)), FacetIndex((7, 2)), FacetIndex((8, 2)), FacetIndex((9, 2)), FacetIndex((10, 2))  …  FacetIndex((845, 2)), FacetIndex((846, 2)), FacetIndex((847, 2)), FacetIndex((848, 2)), FacetIndex((849, 2)), FacetIndex((850, 2)), FacetIndex((851, 2)), FacetIndex((852, 2)), FacetIndex((853, 2)), FacetIndex((854, 2))])))), OrderedCollections.OrderedDict{String, Thunderbolt.InterfaceSubdomainDesriptor}()), 1320), [1, 2, 3, 4, 5, 6, 7, 8, 9, 10  …  1311, 1312, 1313, 1314, 1315, 1316, 1317, 1318, 1319, 1320], Dict(1144 =&gt; 1144, 1175 =&gt; 1175, 719 =&gt; 719, 1028 =&gt; 1028, 699 =&gt; 699, 831 =&gt; 831, 1299 =&gt; 1299, 1074 =&gt; 1074, 319 =&gt; 319, 687 =&gt; 687…), :φₘ, :Z), [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.3228124288530138 0.31328170147136813 … -0.07492340442627253 -0.07689159318238695; 0.042265844904757495 0.044573905360520555 … -0.040074719627719725 -0.038400489638246896], Vector{VertexIndex}[[VertexIndex((281, 5)), VertexIndex((294, 6))], [VertexIndex((287, 6)), VertexIndex((413, 7))]])</code></pre><div class="admonition is-todo"><header class="admonition-header">Todo</header><div class="admonition-body"><p>Improve the ECG API to not spill all the internals. :)</p></div></div><p>We compute the ECG online as follows.</p><pre><code class="language-julia hljs">io = ParaViewWriter(&quot;ep04_ecg&quot;)
for (u, t) in TimeChoiceIterator(integrator, tspan[1]:dtvis:tspan[2])
    dh = heart_odeform.functions[1].dh
    φ = u[heart_odeform.solution_indices[1]]
    store_timestep!(io, t, dh.grid) do file
        Thunderbolt.store_timestep_field!(file, t, dh, φ, :φₘ)
    end

    # To compute the ECG we just need to update the ecg cache
    Thunderbolt.update_ecg!(geselowitz_ecg, φ)
    # which then allows us to evaluate the leads like this
    electrode_values = Thunderbolt.evaluate_ecg(geselowitz_ecg)
    @info &quot;$t: Lead 1=$(electrode_values[1]) | Lead 2= $(electrode_values[2])&quot;
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[ Info: 0.0: Lead 1=-3.208458731384549e-14 | Lead 2= 1.8407579696363194e-14
[ Info: 0.5: Lead 1=5.876597607956866e-6 | Lead 2= 8.922010604022603e-7</code></pre><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><div class="citation noncanonical"><dl></dl></div><h2 id="ep-tutorial_geselowitz-ecg-plain-program"><a class="docs-heading-anchor" href="#ep-tutorial_geselowitz-ecg-plain-program">Plain program</a><a id="ep-tutorial_geselowitz-ecg-plain-program-1"></a><a class="docs-heading-anchor-permalink" href="#ep-tutorial_geselowitz-ecg-plain-program" title="Permalink"></a></h2><p>Here follows a version of the program without any comments. The file is also available here: <a href="../ep04_geselowitz-ecg.jl"><code>ep04_geselowitz-ecg.jl</code></a>.</p><pre><code class="language-julia hljs">using Thunderbolt, LinearAlgebra, StaticArrays

function steady_state_initializer!(u₀, f::GenericSplitFunction)
    # TODO cleaner implementation. We need to extract this from the types or via dispatch.
    heatfun = f.functions[1]
    heat_dofrange = f.solution_indices[1]
    odefun = f.functions[2]
    ionic_model = odefun.ode

    φ₀ = @view u₀[heat_dofrange];
    # TODO extraction these via utility functions
    dh = heatfun.dh
    s₀flat = @view u₀[(ndofs(dh)+1):end];
    # Should not be reshape but some array of arrays fun
    s₀ = reshape(s₀flat, (ndofs(dh), Thunderbolt.num_states(ionic_model)-1));
    default_values = Thunderbolt.default_initial_state(ionic_model)

    φ₀ .= default_values[1]
    for i ∈ 1:(Thunderbolt.num_states(ionic_model)-1)
        s₀[:, i] .= default_values[i+1]
    end
end

Base.@kwdef struct UniformEndocardialActivation &lt;: Function
    transmural_depth::Float64 = 0.15
end
function (p::UniformEndocardialActivation)(x::Vec{3}, t)
    τᶠ = 0.25
    # TODO source for this
    if t ≤ 2.0 &amp;&amp; x[1] &lt; p.transmural_depth
        return 0.5/τᶠ * exp(t/τᶠ)
    else
        return 0.0
    end
end
protocol = Thunderbolt.AnalyticalTransmembraneStimulationProtocol(
    AnalyticalCoefficient(
        UniformEndocardialActivation(),
        CoordinateSystemCoefficient(CartesianCoordinateSystem{3}())
    ),
    [SVector((-Inf, Inf))],
)

num_elements_heart = (32,16,16)
num_elements_heart = (8,4,4) # hide
heart_mesh = generate_mesh(Tetrahedron, num_elements_heart, Vec((1.5, 1.5, 0.0)), Vec((5.5, 3.5, 2.0)))
num_elements_torso = (56,40,28)
num_elements_torso = (14,10,7) # hide
torso_mesh = generate_mesh(Hexahedron,  num_elements_torso, Vec((0.0, 0.0, 0.0)), Vec((7.0, 5.0, 3.5)))

ground_vertex = Thunderbolt.get_closest_vertex(Vec(0.0, 0.0, 0.0), torso_mesh)
leads = [
    [Vec( 0.,   0.,  1.5), Vec( 7.,   0.,  1.5)],
    [Vec( 3.5,  0.,  1.5), Vec( 3.5,  5.,  1.5)],
]

microstructure = OrthotropicMicrostructureModel(
    ConstantCoefficient((Vec(0.0,0.0,1.0))),
    ConstantCoefficient((Vec(0.0,1.0,0.0))),
    ConstantCoefficient((Vec(1.0,0.0,0.0))),
)

κ₁ = 0.17 * 0.62 / (0.17 + 0.62)
κᵣ = 0.019 * 0.24 / (0.019 + 0.24)
diffusion_tensor_field = SpectralTensorCoefficient(
    microstructure,
    ConstantCoefficient(SVector(κ₁, κᵣ, κᵣ))
)

cellmodel = Thunderbolt.PCG2019()
heart_model = MonodomainModel(
    ConstantCoefficient(1.0),
    ConstantCoefficient(1.0),
    diffusion_tensor_field,
    protocol,
    cellmodel,
    :φₘ, :s
)
heart_odeform = semidiscretize(
    ReactionDiffusionSplit(heart_model),
    FiniteElementDiscretization(Dict(:φₘ =&gt; LagrangeCollection{1}())),
    heart_mesh,
)
u₀ = zeros(Float64, OS.function_size(heart_odeform))
steady_state_initializer!(u₀, heart_odeform)
dt₀ = 0.01
dtvis = 0.5
Tₘₐₓ = 50.0
Tₘₐₓ = dtvis # hide
tspan = (0.0, Tₘₐₓ)
problem = OS.OperatorSplittingProblem(heart_odeform, u₀, tspan)
timestepper = OS.LieTrotterGodunov((
    BackwardEulerSolver(),
    ForwardEulerCellSolver(),
))
integrator = init(problem, timestepper, dt=dt₀, verbose=true)

torso_mesh_κᵢ = ConstantCoefficient(1.0)
torso_mesh_κ  = ConstantCoefficient(1.0)

geselowitz_ecg = Thunderbolt.Geselowitz1989ECGLeadCache(
    heart_odeform,
    torso_mesh,
    torso_mesh_κᵢ,
    torso_mesh_κ,
    leads;
    ground = Thunderbolt.OrderedSet([ground_vertex])
)

io = ParaViewWriter(&quot;ep04_ecg&quot;)
for (u, t) in TimeChoiceIterator(integrator, tspan[1]:dtvis:tspan[2])
    dh = heart_odeform.functions[1].dh
    φ = u[heart_odeform.solution_indices[1]]
    store_timestep!(io, t, dh.grid) do file
        Thunderbolt.store_timestep_field!(file, t, dh, φ, :φₘ)
    end

    # To compute the ECG we just need to update the ecg cache
    Thunderbolt.update_ecg!(geselowitz_ecg, φ)
    # which then allows us to evaluate the leads like this
    electrode_values = Thunderbolt.evaluate_ecg(geselowitz_ecg)
    @info &quot;$t: Lead 1=$(electrode_values[1]) | Lead 2= $(electrode_values[2])&quot;
end</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../ep03_bidomain/">« EP03: Defibrillation (TODO)</a><a class="docs-footer-nextpage" href="../ep05_eikonal/">EP05: Eikonal Models (WIP) »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Tuesday 18 February 2025 19:43">Tuesday 18 February 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
