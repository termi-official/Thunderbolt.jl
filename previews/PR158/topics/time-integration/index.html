<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Time Integration · Thunderbolt.jl</title><meta name="title" content="Time Integration · Thunderbolt.jl"/><meta property="og:title" content="Time Integration · Thunderbolt.jl"/><meta property="twitter:title" content="Time Integration · Thunderbolt.jl"/><meta name="description" content="Documentation for Thunderbolt.jl."/><meta property="og:description" content="Documentation for Thunderbolt.jl."/><meta property="twitter:description" content="Documentation for Thunderbolt.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/custom.css" rel="stylesheet" type="text/css"/><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="Thunderbolt.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Thunderbolt.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/">Overview</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3"><span class="docs-label">Topic Guides</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../">Overview</a></li><li><a class="tocitem" href="../operators/">Operators</a></li><li><a class="tocitem" href="../couplers/">Couplers</a></li><li class="is-active"><a class="tocitem" href>Time Integration</a><ul class="internal"><li><a class="tocitem" href="#Load-Stepping"><span>Load Stepping</span></a></li><li><a class="tocitem" href="#Operator-Splitting"><span>Operator Splitting</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">How-to guides</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../howto/">Overview</a></li><li><a class="tocitem" href="../../howto/benchmarking/">Benchmarking</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">API Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api-reference/">Overview</a></li><li><a class="tocitem" href="../../api-reference/models/">Models</a></li><li><a class="tocitem" href="../../api-reference/mesh/">Mesh</a></li><li><a class="tocitem" href="../../api-reference/functions/">Functions</a></li><li><a class="tocitem" href="../../api-reference/problems/">Problems</a></li><li><a class="tocitem" href="../../api-reference/discretization/">Discretization</a></li><li><a class="tocitem" href="../../api-reference/operators/">Operators</a></li><li><a class="tocitem" href="../../api-reference/solver/">Solver</a></li><li><a class="tocitem" href="../../api-reference/utility/">Utility</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Developer Documentation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../devdocs/">Overview</a></li><li><a class="tocitem" href="../../devdocs/element_interface/">Element Interface</a></li><li><a class="tocitem" href="../../devdocs/domain_management/">Domain management</a></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Topic Guides</a></li><li class="is-active"><a href>Time Integration</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Time Integration</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/termi-official/Thunderbolt.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/termi-official/Thunderbolt.jl/blob/main/docs/src/topics/time-integration.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Time-Integration"><a class="docs-heading-anchor" href="#Time-Integration">Time Integration</a><a id="Time-Integration-1"></a><a class="docs-heading-anchor-permalink" href="#Time-Integration" title="Permalink"></a></h1><h2 id="Load-Stepping"><a class="docs-heading-anchor" href="#Load-Stepping">Load Stepping</a><a id="Load-Stepping-1"></a><a class="docs-heading-anchor-permalink" href="#Load-Stepping" title="Permalink"></a></h2><p>During load stepping we want to solve a nonlinear problem with pseudo-time <span>$t$</span> on some time interval <span>$[t_0, t_1]$</span>. An initial guess is provided for the first nonlinear solve. Formally we can write down the problem as follows. Find <span>$u(t)$</span> such that</p><p class="math-container">\[0 = F(u(t), p, t) \qquad \text{on} \; [t_0, t_1],\]</p><p>where <span>$u$</span> usually descibes the displacement of some mechanical system and the operator <span>$F$</span> contains some mechanical load, hence the name <em>load stepping</em>. We obtain systems with this form if we assume that inertial terms are neglibile, or formally <span>$||d^2_tu|| \approx 0$</span>.</p><h2 id="Operator-Splitting"><a class="docs-heading-anchor" href="#Operator-Splitting">Operator Splitting</a><a id="Operator-Splitting-1"></a><a class="docs-heading-anchor-permalink" href="#Operator-Splitting" title="Permalink"></a></h2><p>For operator splitting procedures we assume that we have some time-dependent problem with initial condition <span>$u_0 := u(t_0)$</span> and an operator <span>$F$</span> describing the right hand side. We assume that <span>$F$</span> can be additively split into <span>$N$</span> suboperators <span>$F_i$</span>. This can be formally written as</p><p class="math-container">\[d_t u(t) = F(u(t), p, t) = F_1(u(t), p, t) + ... + F_N(u(t), p, t) \, .\]</p><p>We call <span>$t$</span> time the <span>$u(t)$</span> the <em>state</em> of the system. This way we can define subproblems</p><p class="math-container">\[\begin{aligned}
    d_t u(t) &amp;= F_1(u(t), p, t) \\
             &amp; \vdots \\
    d_t u(t) &amp;= F_N(u(t), p, t)
\end{aligned}\]</p><p>Now, the key idea of operator splitting methods is that solving the subproblems can be easier, and hopefully more efficient, than solving the full problem. Arguably the easiest algorithm to advance the solution from <span>$t_0$</span> to some time point <span>$t_1 &gt; t_0$</span> is the Lie-Trotter-Godunov operator splitting [<a href="../../references/#Lie:1880:tti">1</a>–<a href="../../references/#God:1959:dmn">3</a>]. Here the subproblems are solved consecutively, where the solution of one subproblem is taken as the initial guess for the next subproblem, until we have  solved all subproblems. In this case we have constructed an <em>approximation</em>  for <span>$u(t_1)$</span>.</p><p>More formally we can write the Lie-Trotter-Godunov scheme [<a href="../../references/#Lie:1880:tti">1</a>–<a href="../../references/#God:1959:dmn">3</a>] as follows:</p><p class="math-container">\[\begin{aligned}
    \text{Solve} \quad d_t u^1(t) &amp;= F_1(u^1(t), p, t) &amp; &amp; \quad \text{on} \; [t_0, t_1] \; \text{with} \; u^1(t_0) = u_0 \\
    \text{Solve} \quad d_t u^2(t) &amp;= F_2(u^2(t), p, t) &amp; &amp; \quad \text{on} \; [t_0, t_1] \; \text{with} \; u^2(t_0) = u^1(t_1) \\
             &amp; \vdots &amp; &amp; \\
    \text{Solve} \quad d_t u^N(t) &amp;= F_N(u^N(t), p, t) &amp; &amp; \quad \text{on} \; [t_0, t_1] \; \text{with} \; u^N(t_0) = u^{N-1}(t_1)
\end{aligned}\]</p><p>Such that we obtain the approximation <span>$u(t_1) \approx u^{N-1}(t_1)$</span>. The approximation is first order in time, as we will show in the next section.</p><p>Probably the most widely spread application for operator splitting schemes is the solution forreaction diffusion systems. These have the form</p><p class="math-container">\[d_t u(t) = Lu + R(u)\]</p><p>where <span>$L$</span> is some linear operator, usually coming from the linaerization of diffusion opeartors and a nonlinear reaction part <span>$R$</span> which has some interesting locality properties. This locallity property usually tells us that the time evolution of <span>$R$</span> natually decouples into many small blocks. This way we only have to solve for the time evolution of a linear problem <span>$d_t u(t) = Lu$</span> and a set of many very small nonlinear problems <span>$d_t u(t) = R(u)$</span>.</p><h3 id="Analysis-of-Lie-Trotter-Godunov"><a class="docs-heading-anchor" href="#Analysis-of-Lie-Trotter-Godunov">Analysis of Lie-Trotter-Godunov</a><a id="Analysis-of-Lie-Trotter-Godunov-1"></a><a class="docs-heading-anchor-permalink" href="#Analysis-of-Lie-Trotter-Godunov" title="Permalink"></a></h3><p>It should be noted that even if we solve all subproblems analytically, then operator splitting schemes themselves almost always come with their own approximation error, which is simply called the splitting error. For linear problems this error can vanish if all suboperators <span>$F_i$</span> commute, i.e. if <span>$F_j \cdot F_i = F_i \cdot F_j$</span> for all <span>$1 \leq i,j \leq N$</span>, which can be shown with the Baker-Campbell-Hausdorff formula. Let us investigate the convergence order for two bounded linear operators <span>$L_1$</span> and <span>$L_2$</span>, i.e. on the following system of ODEs</p><p class="math-container">\[d_t u = L_1 u + L_2 u \, .\]</p><p>Here the exact solution <span>$u$</span> at time point <span>$t$</span> for some initial condition at <span>$t_0 = 0$</span> is</p><p class="math-container">\[u(t) = e^{(L_1 + L_2)t} u_0 \, ,\]</p><p>while the solution for the Lie-Trotter-Godunov scheme is</p><p class="math-container">\[\tilde{u}(t) = e^{L_1t}e^{L_2t} u_0 \, .\]</p><p>The local truncation error can be written as</p><p class="math-container">\[\epsilon(t) = ||e^{L_1t}e^{L_2t} - e^{(L_1 + L_2)t}|| \, ||u_0||\]</p><p>if we now replace the exponentials with their definitions we obtain for the first norm</p><p class="math-container">\[\begin{aligned}
&amp;||(I + tL_1 + \frac{h^2}{2}L_1^2 + ...)(I + tL_2 + \frac{h^2}{2}L_2^2 + ...) - (I + t(L_1 + L_2) + \frac{h^2}{2}(L_1+L_2)^2 + ...)||\\
=&amp; ||\frac{h^2}{2} (L_1 L_2 - L_2 L_1) + ... || \leq \frac{h^2}{2} || (L_1 L_2 - L_2 L_1) || + O(h^3)
\end{aligned}\]</p><p>This shows that the local truncation error is O(h^2) and hence the scheme is first order accurate.</p><p>Showing stability is also straight forward. We assumed that <span>$L_1$</span> and <span>$L_2$</span> are bounded, so we obtain for all time points <span>$t&#39; &lt; t$</span> and all repeated subdivisions <span>$n \in \mathbb{N}$</span> the following bound</p><p class="math-container">\[||(e^{L_1\frac{t&#39;}{n}}e^{L_2\frac{t&#39;}{n}})^n||
\leq ||e^{L_1\frac{t&#39;}{n}}e^{L_2\frac{t&#39;}{n}}||^n
\leq ||e^{L_1\frac{t&#39;}{n}}||^n ||e^{L_2\frac{t&#39;}{n}}||^n
\leq e^{||L_1||t&#39;} e^{||L_2||t&#39;}
\leq e^{||L_1||t} e^{||L_2||t}
\leq C &lt; \infty\]</p><p>which implies stability of the scheme.</p><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><div class="citation noncanonical"><dl><dt>[1]</dt><dd><div>S. Lie. <em>Theorie der Transformationsgruppen I</em>. Mathematische Annalen <strong>16</strong>, 441–528 (1880).</div></dd><dt>[2]</dt><dd><div>H. F. Trotter. <a href="http://www.jstor.org/stable/2033649"><em>On the Product of Semi-Groups of Operators</em></a>. Proceedings of the American Mathematical Society <strong>10</strong>, 545–551 (1959).</div></dd><dt>[3]</dt><dd><div>S. K. Godunov. <em>A difference method for numerical calculation of discontinuous solutions of the equations of hydrodynamics</em>. Matematicheskii Sbornik <strong>89</strong>, 271–306 (1959).</div></dd></dl></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../couplers/">« Couplers</a><a class="docs-footer-nextpage" href="../../howto/">Overview »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Wednesday 6 November 2024 16:37">Wednesday 6 November 2024</span>. Using Julia version 1.10.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
